# ğŸš€ DebateAI éƒ¨ç½²æŒ‡å—

## å‰ç½®éœ€æ±‚

- Node.js 18+
- Python 3.11+
- [uv](https://docs.astral.sh/uv/) (Python å¥—ä»¶ç®¡ç†)
- [Wrangler CLI](https://developers.cloudflare.com/workers/wrangler/) (Cloudflare)
- [gcloud CLI](https://cloud.google.com/sdk/docs/install) (Google Cloud)

---

## ğŸŒ å‰ç«¯éƒ¨ç½² (Cloudflare Pages)

### æ–¹æ³• 1ï¼šä½¿ç”¨ Wrangler CLI

```bash
cd frontend

# 1. å®‰è£ä¾è³´
npm install

# 2. æ§‹å»ºéœæ…‹æª”æ¡ˆ
npm run build

# 3. éƒ¨ç½²åˆ° Cloudflare Pages
npx wrangler pages deploy out --project-name debate-ai
```

### æ–¹æ³• 2ï¼šGit è‡ªå‹•éƒ¨ç½²

1. å°‡ç¨‹å¼ç¢¼æ¨é€åˆ° GitHub
2. åœ¨ Cloudflare Dashboard é€£æ¥ GitHub repo
3. è¨­å®šï¼š
   - Build command: `npm run build`
   - Build output: `out`
   - Root directory: `frontend`

### ç’°å¢ƒè®Šæ•¸ (Cloudflare Dashboard)

| è®Šæ•¸                  | å€¼                                                    |
| --------------------- | ----------------------------------------------------- |
| `NEXT_PUBLIC_API_URL` | `https://debate-api-1046434677262.asia-east1.run.app` |

---

## â˜ï¸ å¾Œç«¯éƒ¨ç½² (Google Cloud Run)

### å¿«é€Ÿéƒ¨ç½²

```bash
cd backend

# 1. å…ˆè¼‰å…¥ç’°å¢ƒè®Šæ•¸ï¼ˆå¾ .env æª”æ¡ˆï¼‰
export $(grep -v '^#' .env | xargs)

# 2. ç¢ºèªç’°å¢ƒè®Šæ•¸å·²è¨­å®š
echo "GROQ_API_KEY: ${GROQ_API_KEY:0:10}..."

# 3. éƒ¨ç½²åˆ° Cloud Run
gcloud run deploy debate-api \
  --source . \
  --region asia-east1 \
  --set-env-vars GROQ_API_KEY=${GROQ_API_KEY},GROQ_MODEL=llama-3.1-8b-instant \
  --memory 512Mi \
  --cpu 1 \
  --timeout 300 \
  --min-instances 0 \
  --max-instances 3 \
  --allow-unauthenticated
```

> âš ï¸ **æ³¨æ„**ï¼šå¦‚æœ `.env` è¼‰å…¥å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¨­å®šï¼š
>
> ```bash
> export GROQ_API_KEY="ä½ çš„é‡‘é‘°"
> ```

### ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸              | èªªæ˜          | ç¯„ä¾‹                               |
| ----------------- | ------------- | ---------------------------------- |
| `GROQ_API_KEY`    | Groq API é‡‘é‘° | `gsk_xxxx...`                      |
| `GROQ_MODEL`      | ä½¿ç”¨çš„æ¨¡å‹    | `llama-3.1-8b-instant`             |
| `ALLOWED_ORIGINS` | CORS ç™½åå–®   | `https://debateai.roy422.ggff.net` |

### æ›´æ–°ç’°å¢ƒè®Šæ•¸

```bash
gcloud run services update debate-api \
  --region asia-east1 \
  --set-env-vars GROQ_API_KEY=æ–°çš„é‡‘é‘°
```

---

## ğŸ” é©—è­‰éƒ¨ç½²

### å¾Œç«¯å¥åº·æª¢æŸ¥

```bash
curl https://debate-api-1046434677262.asia-east1.run.app/health
```

é æœŸå›æ‡‰ï¼š

```json
{
  "status": "healthy",
  "version": "0.2.0",
  "phase": 2,
  "has_groq_key": true
}
```

### å‰ç«¯æ¸¬è©¦

1. æ‰“é–‹ https://debateai.roy422.ggff.net
2. è¼¸å…¥è¾¯è«–ä¸»é¡Œ
3. é»æ“Šã€Œé–‹å§‹è¾¯è«–ã€
4. ç¢ºèª AI ä¸²æµæ­£å¸¸é¡¯ç¤º

---

## ğŸ“ ç”Ÿç”¢ç’°å¢ƒ URL

| æœå‹™ | å¹³å°             | URL                                                 |
| ---- | ---------------- | --------------------------------------------------- |
| å‰ç«¯ | Cloudflare Pages | https://debateai.roy422.ggff.net                    |
| å¾Œç«¯ | Cloud Run        | https://debate-api-1046434677262.asia-east1.run.app |

---

## âš ï¸ å¸¸è¦‹å•é¡Œ

### CORS éŒ¯èª¤

ç¢ºä¿å¾Œç«¯ `ALLOWED_ORIGINS` åŒ…å«å‰ç«¯ç¶²å€ã€‚

### å†·å•Ÿå‹•å»¶é²

Cloud Run `min-instances=0` æœƒå°è‡´ç´„ 10-15 ç§’å†·å•Ÿå‹•ï¼Œå‰ç«¯å·²æœ‰ 30 ç§’è¶…æ™‚è™•ç†ã€‚

### éƒ¨ç½²å¤±æ•—

```bash
# æŸ¥çœ‹ Cloud Run æ—¥èªŒ
gcloud run services logs read debate-api --region asia-east1
```
