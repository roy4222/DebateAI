# ğŸ“… é–‹ç™¼æ—¥è¨˜ï¼šDebateAI - 12/12

**æ—¥æœŸ**ï¼š2025-12-12  
**ç‹€æ…‹**ï¼šâœ… Phase 3b å®Œæˆ - LangGraph + æœå°‹å·¥å…·  
**ç‰ˆæœ¬**ï¼š0.3.1

---

## ğŸ‰ ä»Šæ—¥æˆå°± (Highlights)

### Phase 3aï¼šLangGraph StateGraph é·ç§» âœ…

| æª”æ¡ˆ       | è®Šæ›´å…§å®¹                                                                |
| ---------- | ----------------------------------------------------------------------- |
| `graph.py` | æ–°å¢ `optimist_node`ã€`skeptic_node`ã€`should_continue`ã€`debate_graph` |
| `main.py`  | æ–°å¢ `langgraph_debate_stream()`ã€`USE_LANGGRAPH` é–‹é—œ                  |

### Phase 3bï¼šæœå°‹å·¥å…·æ•´åˆ âœ…

| æª”æ¡ˆ              | è®Šæ›´å…§å®¹                                                          |
| ----------------- | ----------------------------------------------------------------- |
| `tools/search.py` | ä¸‰å±¤å®¹éŒ¯æœå°‹ï¼ˆTavily â†’ DuckDuckGo â†’ å„ªé›…é™ç´šï¼‰                    |
| `graph.py`        | `@tool web_search_tool`ã€`bind_tools`ã€`MAX_TOOL_ITERATIONS=3`    |
| `main.py`         | æ”¹ç”¨ `astream_events(version="v2")`ã€`tool_start`/`tool_end` äº‹ä»¶ |
| `DebateUI.tsx`    | æœå°‹ç‹€æ…‹æŒ‡ç¤ºå™¨ state + event handlers                             |

---

## ğŸ”§ ä»Šæ—¥è§£æ±ºçš„å•é¡Œ

| #   | å•é¡Œ                                         | è§£æ±ºæ–¹æ¡ˆ                                                  |
| --- | -------------------------------------------- | --------------------------------------------------------- |
| 1   | `stream_mode="messages"` ç„¡æ³•æ•ç²å·¥å…·äº‹ä»¶    | æ”¹ç”¨ `astream_events(version="v2")`                       |
| 2   | å·¥å…·èª¿ç”¨å¯èƒ½ç„¡é™å¾ªç’°                         | åŠ å…¥ `MAX_TOOL_ITERATIONS = 3` é™åˆ¶                       |
| 3   | å·¥å…·éŒ¯èª¤å°è‡´æœå°‹æŒ‡ç¤ºå™¨å¡ä½                   | åŠ å…¥ `on_tool_error` è™•ç† + error handler ç™¼é€ `tool_end` |
| 4   | ç‰ˆæœ¬/Phase æ¨™ç¤ºä¸ä¸€è‡´                        | çµ±ä¸€æ›´æ–°ç‚º v0.3.1 / Phase 3b                              |
| 5   | `llama-3.1-8b-instant` function calling å¤±æ•— | æ›ç”¨ `openai/gpt-oss-120b` æ¨¡å‹                           |

---

## ğŸ› å·²çŸ¥å•é¡Œ / å¾…æ”¹é€²

### é«˜å„ªå…ˆç´š

1. **æœå°‹æŒ‡ç¤ºå™¨å‹•ç•«ç¼ºå¤±**ï¼šå‰ç«¯æ²’æœ‰é¡¯ç¤ºã€Œæ­£åœ¨æœå°‹ä¸­ã€çš„å‹•ç•«æ•ˆæœï¼Œä½¿ç”¨è€…ä¸çŸ¥é“æœå°‹é€²è¡Œä¸­
2. **ç¬¬ä¸€è¼ªè¾¯è«–è€…æœ‰æ™‚æ²’æœ‰è¼¸å‡º**ï¼šè¼¸å…¥å•é¡Œå¾Œï¼Œç¬¬ä¸€å€‹è¾¯è«–è€…ï¼ˆæ¨‚è§€è€…ï¼‰æœ‰æ™‚æ²’æœ‰å…§å®¹è¼¸å‡ºï¼Œå¯èƒ½èˆ‡ web tool æœ‰é—œ

### ä¸­å„ªå…ˆç´š

3. **æœå°‹çµæœæœªé¡¯ç¤ºä¾†æºé€£çµ**ï¼šæœå°‹åˆ°çš„è³‡æ–™æ‡‰é™„ä¸ŠåŸå§‹ç¶²ç«™é€£çµï¼Œæ–¹ä¾¿é©—è­‰
4. **æœå°‹éç¨‹ä¸å¤ é€æ˜**ï¼šæ‡‰é¡¯ç¤ºæ›´è©³ç´°çš„é€²åº¦ï¼Œä¾‹å¦‚ã€Œæ‰¾åˆ° 3 å€‹ç¶²ç«™ã€ã€Œæ­£åœ¨åˆ†æç¬¬ 2 å€‹çµæœã€

---

## ğŸ“ æŠ€è¡“ç­†è¨˜

### astream_events äº‹ä»¶é¡å‹

```python
event_type == "on_chain_start"      # ç¯€é»é–‹å§‹
event_type == "on_tool_start"       # å·¥å…·é–‹å§‹
event_type == "on_tool_end"         # å·¥å…·çµæŸ
event_type == "on_tool_error"       # å·¥å…·éŒ¯èª¤
event_type == "on_chat_model_stream" # Token ä¸²æµ
```

### ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸             | é è¨­å€¼                | èªªæ˜                           |
| ---------------- | --------------------- | ------------------------------ |
| `GROQ_MODEL`     | `openai/gpt-oss-120b` | LLM æ¨¡å‹                       |
| `USE_LANGGRAPH`  | `true`                | å•Ÿç”¨ LangGraph StateGraph æ¨¡å¼ |
| `TAVILY_API_KEY` | ï¼ˆå¯é¸ï¼‰              | Tavily æœå°‹ API Key            |

---

## ğŸ“Š å°ˆæ¡ˆé€²åº¦

| éšæ®µ                       | ç‹€æ…‹      | å®Œæˆåº¦ |
| -------------------------- | --------- | ------ |
| Phase 0ï¼ˆåŸºç¤æ¶æ§‹ï¼‰        | âœ… å®Œæˆ   | 100%   |
| Phase 1ï¼ˆé›²ç«¯éƒ¨ç½²ï¼‰        | âœ… å®Œæˆ   | 100%   |
| Phase 2ï¼ˆAI è¾¯è«–ï¼‰         | âœ… å®Œæˆ   | 100%   |
| Phase 3aï¼ˆLangGraph é·ç§»ï¼‰ | âœ… å®Œæˆ   | 100%   |
| Phase 3bï¼ˆæœå°‹å·¥å…·ï¼‰       | âœ… å®Œæˆ   | 100%   |
| Phase 3cï¼ˆModeratorï¼‰      | ğŸ”œ å¾…é–‹å§‹ | 0%     |

---

## ğŸ“Œ ä¸‹ä¸€æ­¥

1. ä¿®å¾©æœå°‹æŒ‡ç¤ºå™¨å‹•ç•«ï¼ˆå‰ç«¯ UI æ”¹é€²ï¼‰
2. èª¿æŸ¥ã€Œç¬¬ä¸€è¼ªç„¡è¼¸å‡ºã€å•é¡Œ
3. åŠ å…¥æœå°‹ä¾†æºé€£çµ
4. æ”¹é€²æœå°‹é€²åº¦é¡¯ç¤º
5. Phase 3cï¼šModerator Agentï¼ˆç¸½çµå ±å‘Šï¼‰
