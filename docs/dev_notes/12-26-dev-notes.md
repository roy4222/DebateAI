# é–‹ç™¼æ—¥è¨˜ 2025-12-26

## ğŸ“‹ ä»Šæ—¥ç›®æ¨™

Groq API é™æµå®¹éŒ¯æ©Ÿåˆ¶ + ç¹¼çºŒå®Œæˆå¾…è¾¦äº‹é …

---

## âœ… å®Œæˆäº‹é …

### 1. Groq API Rate Limit æ¨¡å‹åˆ‡æ›æ©Ÿåˆ¶

- âœ… `app/graph.py` - æ–°å¢ `RateLimitRetryLLM` åŒ…è£å™¨é¡åˆ¥
  - é‡åˆ° 429 é™æµéŒ¯èª¤æ™‚è‡ªå‹•åˆ‡æ›åˆ°å‚™ç”¨æ¨¡å‹
  - ç¶­è­·ã€Œå·²é™æµã€æ¨¡å‹é›†åˆï¼Œé¿å…é‡è¤‡å˜—è©¦
  - æ‰€æœ‰æ¨¡å‹éƒ½é™æµæ™‚ï¼Œç­‰å¾… 10 ç§’å¾Œé‡ç½®

**å‚™ç”¨æ¨¡å‹åˆ—è¡¨ï¼š**

```python
DEFAULT_FALLBACK_MODELS = [
    "moonshotai/kimi-k2-instruct-0905",  # Moonshot Kimi K2ï¼Œé«˜å“è³ª
    "llama-3.1-8b-instant",               # é«˜é…é¡ï¼Œå¿«é€Ÿ
]
```

**ç’°å¢ƒè®Šæ•¸æ”¯æ´ï¼š**

```bash
GROQ_MODEL=openai/gpt-oss-120b          # ä¸»è¦æ¨¡å‹
GROQ_FALLBACK_MODELS=kimi-k2,llama-3.1  # å¯è‡ªè¨‚å‚™ç”¨æ¨¡å‹ï¼ˆé€—è™Ÿåˆ†éš”ï¼‰
```

### 2. é—œéµè¨­è¨ˆæ±ºç­–

| æ±ºç­–          | é¸æ“‡                   | ç†ç”±               |
| :------------ | :--------------------- | :----------------- |
| é™æµå®¹éŒ¯      | é¡ç´šåˆ¥ cooldown set    | è·¨è«‹æ±‚å…±äº«é™æµç‹€æ…‹ |
| æ¨¡å‹åˆ‡æ›      | ç«‹å³åˆ‡æ›ï¼Œç„¡éœ€ç­‰ 7 ç§’  | æå‡ç”¨æˆ¶é«”é©—       |
| Fallback æ¨¡å‹ | Kimi K2 + llama-3.1-8b | å“è³ªèˆ‡é…é¡å¹³è¡¡     |

---

## ğŸ“ æª”æ¡ˆè®Šæ›´ç¸½è¦½

### Backend (ä¿®æ”¹)

```
backend/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ graph.py              # [MODIFIED] æ–°å¢ RateLimitRetryLLM é¡åˆ¥
```

---

## ğŸ”œ å¾…è¾¦äº‹é …

### Testing + CI/CDï¼ˆå»¶çºŒ 12-22ï¼‰

- [ ] Backend æ¸¬è©¦ (pytest)
  - [ ] `tests/conftest.py` - Mock Supabase
  - [ ] `tests/test_service.py` - debate_service å–®å…ƒæ¸¬è©¦
  - [ ] `tests/test_main.py` - API æ•´åˆæ¸¬è©¦
- [ ] Frontend æ¸¬è©¦ (Vitest)
  - [ ] `__tests__/lib/api.test.ts`
  - [ ] `__tests__/components/*.test.tsx`
- [ ] GitHub Actions
  - [ ] `.github/workflows/test.yml`

### éƒ¨ç½²ï¼ˆå»¶çºŒ 12-22ï¼‰

- [ ] æ›´æ–° Cloud Run å¾Œç«¯ (å«æ–° API + é™æµå®¹éŒ¯)
- [ ] æ›´æ–° Cloudflare Pages å‰ç«¯
- [ ] è¨­å®šç”Ÿç”¢ç’°å¢ƒ Supabase ç’°å¢ƒè®Šæ•¸

### å…¶ä»–å„ªåŒ–

- [ ] æ·»åŠ æ¨¡å‹åˆ‡æ›çš„ SSE äº‹ä»¶é€šçŸ¥ï¼ˆè®“å‰ç«¯é¡¯ç¤ºç•¶å‰ä½¿ç”¨çš„æ¨¡å‹ï¼‰
- [ ] ç›£æ§ Groq API ä½¿ç”¨é‡çµ±è¨ˆ
